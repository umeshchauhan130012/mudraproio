import React, { useEffect, useState } from "react";
import { useSelector } from "react-redux";
import styles from "../styles/dashboard.module.css";
import CircularProgress from '@mui/material/CircularProgress';

export default function ReferralCopy() {
  const [referralLink, setReferralLink] = useState("");
  const [copysucess, setCopysucess] = useState(false);
  const [loader, setLoader] = useState(true);
  const status = useSelector((state) => state);
  useEffect(() => {
    if (status.dashboardDetails.data !== "") {
      if (status.dashboardDetails.data.data.statusCode === "200") {
        setReferralLink(status.dashboardDetails.data.data.result[0]);
      }
    }
    if (status.dashboardDetails.error === '500') {
      setLoader(false);
    }
  }, [status]);

  return (
    <div className={`${styles.refralcopywrap} ${styles.bordercolor}`}>
      <div className={styles.refall}>
        <span className={styles.refraltext}>Referral Link</span>
        
        {referralLink && referralLink.referralLinkurl ? <input
          type="text"
          readOnly
          value={
            referralLink && referralLink.referralLinkurl === null
              ? "No Referral Link"
              : referralLink && referralLink.referralLinkurl
          }
          className={styles.refallcopy}
          onChange={(e) => setReferralLink(e.target.value)}
        /> : <label className={styles.refallcopy}>{loader ? <CircularProgress size="15px" style={{ color: "#0164eb", position: "relative", top: "6px" }}/> : "No Referral Link" }</label> }
        <span
          className={styles.copuelement}
          data-title={copysucess ? "copied" : ""}
        >
          <span
            className={styles.cpyclipboard}
            onClick={() => {
              navigator.clipboard.writeText(referralLink.referralLinkurl);
              setCopysucess(true);
              setTimeout(() => {
                setCopysucess(false);
              }, 1000);
            }}
          >
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path
                d="M18 19.5C18 20.2956 17.6839 21.0587 17.1213 21.6213C16.5587 22.1839 15.7956 22.5 15 22.5H4.5C3.70435 22.5 2.94129 22.1839 2.37868 21.6213C1.81607 21.0587 1.5 20.2956 1.5 19.5V9C1.5 8.20435 1.81607 7.44129 2.37868 6.87868C2.94129 6.31607 3.70435 6 4.5 6V7.5C4.10218 7.5 3.72064 7.65804 3.43934 7.93934C3.15804 8.22064 3 8.60218 3 9V19.5C3 19.8978 3.15804 20.2794 3.43934 20.5607C3.72064 20.842 4.10218 21 4.5 21H15C15.3978 21 15.7794 20.842 16.0607 20.5607C16.342 20.2794 16.5 19.8978 16.5 19.5H18Z"
                fill="#0164EB"
              />
              <path
                d="M9 3C8.60218 3 8.22064 3.15804 7.93934 3.43934C7.65804 3.72064 7.5 4.10218 7.5 4.5V15C7.5 15.3978 7.65804 15.7794 7.93934 16.0607C8.22064 16.342 8.60218 16.5 9 16.5H19.5C19.8978 16.5 20.2794 16.342 20.5607 16.0607C20.842 15.7794 21 15.3978 21 15V4.5C21 4.10218 20.842 3.72064 20.5607 3.43934C20.2794 3.15804 19.8978 3 19.5 3H9ZM9 1.5H19.5C20.2956 1.5 21.0587 1.81607 21.6213 2.37868C22.1839 2.94129 22.5 3.70435 22.5 4.5V15C22.5 15.7956 22.1839 16.5587 21.6213 17.1213C21.0587 17.6839 20.2956 18 19.5 18H9C8.20435 18 7.44129 17.6839 6.87868 17.1213C6.31607 16.5587 6 15.7956 6 15V4.5C6 3.70435 6.31607 2.94129 6.87868 2.37868C7.44129 1.81607 8.20435 1.5 9 1.5Z"
                fill="#0164EB"
              />
            </svg>
          </span>
          {/* <span className={styles.sharelink}>
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path
                d="M17.2493 15.0002C16.6879 15.003 16.1343 15.1318 15.6293 15.3771C15.1244 15.6225 14.681 15.9781 14.3318 16.4177L8.84928 12.9902C9.0491 12.3453 9.0491 11.655 8.84928 11.0102L14.3318 7.58265C14.8882 8.27169 15.6706 8.74154 16.5403 8.90896C17.41 9.07638 18.3109 8.93058 19.0834 8.49737C19.8559 8.06417 20.4502 7.37152 20.7609 6.54214C21.0716 5.71276 21.0787 4.80017 20.781 3.96603C20.4833 3.13189 19.8999 2.43005 19.1343 1.98483C18.3687 1.5396 17.4702 1.37974 16.5979 1.53356C15.7257 1.68737 14.9361 2.14493 14.369 2.82519C13.8018 3.50545 13.4937 4.3645 13.4993 5.25015C13.5028 5.58554 13.5533 5.91877 13.6493 6.24015L8.16678 9.66765C7.68277 9.05834 7.02119 8.61469 6.27375 8.3982C5.52631 8.18171 4.73003 8.2031 3.99529 8.45941C3.26056 8.71572 2.62375 9.19426 2.17315 9.82868C1.72255 10.4631 1.48047 11.222 1.48047 12.0002C1.48047 12.7783 1.72255 13.5372 2.17315 14.1716C2.62375 14.8061 3.26056 15.2846 3.99529 15.5409C4.73003 15.7972 5.52631 15.8186 6.27375 15.6021C7.02119 15.3856 7.68277 14.942 8.16678 14.3327L13.6493 17.7602C13.5533 18.0815 13.5028 18.4148 13.4993 18.7502C13.4993 19.4918 13.7192 20.2169 14.1313 20.8335C14.5433 21.4502 15.129 21.9309 15.8142 22.2147C16.4994 22.4985 17.2534 22.5728 17.9809 22.4281C18.7083 22.2834 19.3765 21.9263 19.9009 21.4018C20.4254 20.8774 20.7825 20.2092 20.9272 19.4817C21.0719 18.7543 20.9977 18.0003 20.7138 17.3151C20.43 16.6299 19.9494 16.0442 19.3327 15.6321C18.716 15.2201 17.991 15.0002 17.2493 15.0002ZM17.2493 3.00015C17.6943 3.00015 18.1293 3.13211 18.4993 3.37935C18.8693 3.62658 19.1577 3.97798 19.328 4.38912C19.4983 4.80025 19.5429 5.25265 19.4561 5.68911C19.3692 6.12556 19.1549 6.52648 18.8403 6.84114C18.5256 7.15581 18.1247 7.3701 17.6882 7.45692C17.2518 7.54374 16.7994 7.49918 16.3882 7.32888C15.9771 7.15859 15.6257 6.8702 15.3785 6.50019C15.1312 6.13018 14.9993 5.69516 14.9993 5.25015C14.9993 4.65342 15.2363 4.08112 15.6583 3.65916C16.0803 3.23721 16.6525 3.00015 17.2493 3.00015ZM5.24928 14.2502C4.80428 14.2502 4.36926 14.1182 3.99925 13.871C3.62924 13.6237 3.34085 13.2723 3.17055 12.8612C3.00026 12.4501 2.9557 11.9977 3.04252 11.5612C3.12933 11.1247 3.34363 10.7238 3.65829 10.4092C3.97296 10.0945 4.37387 9.8802 4.81033 9.79339C5.24679 9.70657 5.69919 9.75113 6.11032 9.92142C6.52146 10.0917 6.87286 10.3801 7.12009 10.7501C7.36732 11.1201 7.49928 11.5551 7.49928 12.0002C7.49928 12.5969 7.26223 13.1692 6.84027 13.5911C6.41832 14.0131 5.84602 14.2502 5.24928 14.2502ZM17.2493 21.0002C16.8043 21.0002 16.3693 20.8682 15.9993 20.621C15.6292 20.3737 15.3409 20.0223 15.1706 19.6112C15.0003 19.2001 14.9557 18.7477 15.0425 18.3112C15.1293 17.8747 15.3436 17.4738 15.6583 17.1592C15.973 16.8445 16.3739 16.6302 16.8103 16.5434C17.2468 16.4566 17.6992 16.5011 18.1103 16.6714C18.5215 16.8417 18.8729 17.1301 19.1201 17.5001C19.3673 17.8701 19.4993 18.3051 19.4993 18.7502C19.4993 19.3469 19.2622 19.9192 18.8403 20.3411C18.4183 20.7631 17.846 21.0002 17.2493 21.0002Z"
                fill="#0164EB"
              />
            </svg>
          </span> */}
        </span>
      </div>
    </div>
  );
}
